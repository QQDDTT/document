# React 组件状态(State)

## 类组件中的状态管理

```JSX
import React, { Component } from 'react';

class Counter extends Component {
  constructor(props) {
    super(props);
    this.state = { count: 0 };
  }

  increment = () => {
    this.setState({ count: this.state.count + 1 });
  }

  render() {
    return (
      <div>
        <p>Count: {this.state.count}</p>
        <button onClick={this.increment}>Increment</button>
      </div>
    );
  }
}

export default Counter;
```

## 函数组件中的状态管理（使用 Hook）

```csharp
class Clock extends React.Component {
  constructor(props) {
    super(props);
    this.state = {date: new Date()};
  }
 
  render() {
    return (
      <div>
        <h1>Hello, world!</h1>
        <h2>现在是 {this.state.date.toLocaleTimeString()}.</h2>
      </div>
    );
  }
}
 
const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <Clock />
);
```

## 将生命周期方法添加到类中

```csharp
class Clock extends React.Component {
  constructor(props) {
    super(props);
    this.state = {date: new Date()};
  }
  
  // 生命周期方法：
  // 当组件第一次被挂载到 DOM 之后执行（只执行一次）
  componentDidMount() {
    // 设置一个定时器，每 1 秒调用一次 tick 方法
    // 用于更新时间
    this.timerID = setInterval(
      () => this.tick(),
      1000
    );
  }
 
  // 生命周期方法：
  // 当组件即将从 DOM 中移除之前执行
  componentWillUnmount() {
    // 清除定时器，防止内存泄漏
    clearInterval(this.timerID);
  }
  
  // 自定义方法：
  // 用于更新 state 中的时间
  tick() {
    this.setState({
      date: new Date()
    });
  }

  // render 方法：
  // 返回要渲染到页面上的 JSX
  render() {
    return (
      <div>
        <h1>Hello, world!</h1>
        <h2>现在是 {this.state.date.toLocaleTimeString()}.</h2>
      </div>
    );
  }
}

// 获取页面中的 root 节点
const root = ReactDOM.createRoot(document.getElementById("root"));

// 将 Clock 组件渲染到页面中
root.render(
  <Clock />
);
```